specVersion: 0.0.2

schema:
    file: ./schema.graphql

dataSources:

    - kind: ethereum/contract
      name: Topx
      network: ropsten
      source:
        abi: Topx
        startBlock: 10300000
        address: '0xa4D9f9bf1bf27e59D714E7E7F9A02672A9dB8C8E'
      mapping:
        kind: ethereum/events
        apiVersion: 0.0.4
        language: wasm/assemblyscript
        entities:
          - LootBox
          - LootBoxItem
          - Token
          - EthTransfer
        file: ./src/mapping.ts
        abis:
          - name: IERC165Upgradeable
            file: contracts/IERC165Upgradeable.json
          - name: Topx
            file: contracts/Topx.json
        eventHandlers:
          - event: addLootBox(uint256,uint256,uint256,uint256,uint256) 
            handler: handleAddLootBox
          - event: addLootBoxItem(uint256,uint256,uint256,uint256,uint256) 
            handler: handleAddLootBoxItem
          - event: mintLootBox(uint256,address,uint256,uint256)
            handler: handleMintLootBox
          - event: mintItem(uint256,address,uint256)
            handler: handleMintItem
          - event: TransferSingle(indexed address,indexed address,indexed address,uint256,uint256) 
            handler: handleTransferSingle
          - event:  TransferBatch(indexed address,indexed address,indexed address,uint256[],uint256[])
            handler: handleTransferBatch
          - event: EthTransfer(uint8,uint8,uint256,uint256,address)
            handler: handleEthTransfer
  
    - kind: ethereum/contract
      name: Marketplace
      network: ropsten
      source:
        abi: Marketplace
        startBlock: 10300000
        address: '0x30ABA49B6205f04E483ee28D8507D16DEC819B9D'
      mapping:
        kind: ethereum/events
        apiVersion: 0.0.4
        language: wasm/assemblyscript
        entities:
          - LootBox
          - LootBoxItem
          - Token
          - Order
          - OrderReceipt
          - EthTransfer
        file: ./src/mapping.ts
        abis:
          - name: Marketplace
            file: contracts/Marketplace.json
        eventHandlers:
          - event: OrderCreated(address,uint256,uint256) 
            handler: handleOrderCreated
          - event: OrderBought(address,uint256) 
            handler: handleOrderBought
          - event: OrderCanceled(uint256) 
            handler: handleOrderCanceled
          - event: EthTransfer(uint8,uint8,uint256,uint256,address)
            handler: handleEthTransfer